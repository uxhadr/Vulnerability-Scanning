# Vulnerability-Scanning
I went to the Nessus website and downloaded Tenale Nessus for Mac
![image](https://github.com/user-attachments/assets/fda5f1e1-83fd-48cb-934d-4da400b789f2)

Downloaded Nessus and opened it and registered for the Nessus Essentials
<img width="1024" alt="image" src="https://github.com/user-attachments/assets/1c16faf8-8281-47d4-9d4f-5eb60a0725cb">

I then used my activation code and created a Nessus Essentials account
<img width="1512" alt="image" src="https://github.com/user-attachments/assets/fc917d08-f8f7-46d9-b33d-bff526e1a295">

First scan I did was a basic scan on the vulnerable Azure VM that I set up for my SIEM lab using its public ip address. I set up the new scan then I clicked on launch.
<img width="1310" alt="image" src="https://github.com/user-attachments/assets/14e9c9f7-b2c8-465e-8294-930dcc185697"> 
<img width="1316" alt="image" src="https://github.com/user-attachments/assets/20ca7be4-8e18-43f2-9ed9-e317f0dd211e">

I used RDP to get into the Windows 10 Azure VM. I enbabled remote registry which will allow the scanner to get into the remote registry and look for insecure configurations.
<img width="954" alt="image" src="https://github.com/user-attachments/assets/54d22fd1-1f2a-4bef-a464-a3832744e6ad">

I made sure the file and printer sharing was turned on
<img width="1127" alt="image" src="https://github.com/user-attachments/assets/55a38f7d-cca2-4883-8e4a-4af469a022da">

Opened registry> local machine> software>Microsft>Windows>current version>policies>system. In system I created a new DWORD named 'LocalAccountTokenFilterPolicy' and then set its value to 1.Then I restated the machine.
<img width="1118" alt="image" src="https://github.com/user-attachments/assets/2e05d3b5-68d0-49d1-b7c2-7496f1186cef">

I went back to Nessus and configured my initial basic scan, now i added credentials for Nessus to use when scanning the machine and then I ran the scan one more time.
<img width="1311" alt="image" src="https://github.com/user-attachments/assets/0015f258-b5f2-45cd-9c0d-56678ba78052">
<img width="1321" alt="image" src="https://github.com/user-attachments/assets/a918d84b-9206-410c-a57d-617871466b61">

I kept running the credentialed scan but I kept getting the same results. 
<img width="1512" alt="image" src="https://github.com/user-attachments/assets/7b5b94c3-8148-4b0c-ace3-1a90a1d7e2e9">

I opened powershell and ran the following code to enable WinRM
'# Enable PowerShell remoting
Enable-PSRemoting -Force

# Allow basic authentication for WinRM
Set-Item WSMan:\localhost\Service\Auth\Basic -Value $true

# Allow unencrypted traffic (if SSL is not configured)
Set-Item WSMan:\localhost\Service\AllowUnencrypted -Value $true

# Set the WinRM service to start automatically
Set-Service -Name WinRM -StartupType Automatic

# Start the WinRM service
Start-Service -Name WinRM'

I configured the firewall to allow WinRM traffic
'# Allow WinRM HTTP traffic (port 5985)
New-NetFirewallRule -Name "WinRM_HTTP" -DisplayName "Allow WinRM over HTTP" -Protocol TCP -LocalPort 5985 -Action Allow

# Allow WinRM HTTPS traffic (port 5986)
New-NetFirewallRule -Name "WinRM_HTTPS" -DisplayName "Allow WinRM over HTTPS" -Protocol TCP -LocalPort 5986 -Action Allow'

I ran the following commands to ensure that WinRM is configured correctly
'# Check WinRM listener configuration
winrm enumerate winrm/config/listener

# Test WinRM connectivity
Test-WsMan'
<img width="653" alt="image" src="https://github.com/user-attachments/assets/3e08bfa2-8456-4dec-9a47-0f43daeb5e7c">

It worked and it now showed more vulnerabilities thatn earlier
<img width="1323" alt="image" src="https://github.com/user-attachments/assets/3e910a5e-42ef-4168-a953-fff7337ffcc1">

I saw this vulnerability and decided to fix it: The vulnerability you're encountering, SSL Medium Strength Cipher Suites Supported (SWEET32), relates to the use of cryptographic algorithms that are considered weak due to their vulnerability to specific attacks, such as the SWEET32 attack. This attack can exploit the 3DES (Triple DES) encryption to decrypt sensitive data if an attacker is on the same network
How to Fix the Vulnerability
Disable Weak Ciphers: To mitigate this vulnerability, you need to disable the use of weak ciphers on the affected system. This typically involves modifying the SSL/TLS configuration of your server or application.
Configure SSL/TLS Settings: Depending on your environment, this could involve adjusting the settings on a web server (like Apache, Nginx, or IIS), a load balancer, or any application that provides SSL/TLS services. Here are the steps for common environments:
<img width="1276" alt="image" src="https://github.com/user-attachments/assets/a84fd576-989f-426a-8639-dcdf77ce2ee0">

I opened 'regedit' and navigated to:
'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers'

I followed the following steps:
<img width="1122" alt="image" src="https://github.com/user-attachments/assets/3968c4e1-dbf2-4efc-b625-beadd09e8392">

To disable weak ciphers i used powershell and typed in the following commands: 
'# Disable 3DES cipher
New-Item -Path "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\Triple DES 168" -Force
New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\Triple DES 168" -Name "Enabled" -Value 0 -PropertyType "DWORD" -Force

# Disable RC4 ciphers
New-Item -Path "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 128/128" -Force
New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 128/128" -Name "Enabled" -Value 0 -PropertyType "DWORD" -Force

New-Item -Path "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 64/128" -Force
New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 64/128" -Name "Enabled" -Value 0 -PropertyType "DWORD" -Force

New-Item -Path "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 40/128" -Force
New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 40/128" -Name "Enabled" -Value 0 -PropertyType "DWORD" -Force
'

I applied the changes and then i restarted the computer
<img width="1348" alt="image" src="https://github.com/user-attachments/assets/cd83a0e2-f61d-4c09-ab52-27804768b9b8">

I ran the Nessus scan again to see if it fixed the High severity. The vulnerability was remediated as the SSL high severity vulnerability wasn't showing up anymore
<img width="1313" alt="image" src="https://github.com/user-attachments/assets/5afee2d1-556f-4f22-a52e-bf38c748a34b">


